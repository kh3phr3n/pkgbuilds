# Maintainer: Remi Casanova <rc.dev@tuxico.com>
# Contributor: Andy Kluger <AndyKluger@gmail.com>
# Contributor: Markus Weimar <mail@markusweimar.de>

pkgname=ttf-iosevka-custom
pkgver=2.2.1
pkgrel=1

arch=('any')
depends=('fontconfig' 'xorg-font-utils')
makedepends=('git' 'npm' 'nodejs' 'otfcc' 'ttfautohint')

license=('custom:OFL')
url="https://be5invis.github.io/Iosevka/"
pkgdesc="Spatial efficient monospace font family for programming."

source=(
    "private-build-plans.toml"
    "https://github.com/be5invis/Iosevka/archive/v${pkgver}.tar.gz"
)

sha256sums=(
    "389464e0c1c884ba11d6ff763704d0a35776f6e586885c0549ae4f4f0bed023d"
    "cc9456cd255c496c962c4b85f4b379c755f8610ddea5704bcabd4c60ec5f852c"
)

build() {
    cd ${srcdir}/Iosevka-${pkgver} && cp ../private-build-plans.toml . && sed -i "/^width/s/500/525/" parameters.toml
    npm install && npm run build -- contents::iosevka-custom
}

package() {
    install -Dm644 ${srcdir}/Iosevka-${pkgver}/dist/*/ttf/*.ttf -t ${pkgdir}/usr/share/fonts/iosevka
    install -Dm644 ${srcdir}/Iosevka-${pkgver}/LICENSE.md ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE.md
}

